

============================== 2022-11-28 21:46:07.945105 | 05d9afd4-62a5-4fe0-89c0-ea855c6c413c ==============================
[0m21:46:07.945105 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:46:07.946105 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_name': 'buyma', 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m21:46:07.946105 [debug] [MainThread]: Tracking: tracking
[0m21:46:07.947107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001797CF59EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001797CF59E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001797CF59DC0>]}
[0m21:46:07.947107 [info ] [MainThread]: Creating dbt configuration folder at C:\Users\Ruoyu\.dbt
[0m21:46:07.949106 [debug] [MainThread]: Starter project path: c:\users\ruoyu\appdata\local\programs\python\python39\lib\site-packages\dbt\include\starter_project
[0m22:04:39.074936 [info ] [MainThread]: Profile buyma written to C:\Users\Ruoyu\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m22:04:39.075935 [info ] [MainThread]: 
Your new dbt project "buyma" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m22:04:39.077936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001791DD0A760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001791E03E100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001791E03E0D0>]}
[0m22:04:39.077936 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 00:25:50.216475 | 72972a02-6878-4414-be70-e9db68b4f8ea ==============================
[0m00:25:50.216475 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:25:50.217475 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
[0m00:25:50.217475 [debug] [MainThread]: Tracking: tracking
[0m00:25:50.218478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AF9450BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AF9450D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AF9450D30>]}
[0m00:25:50.218478 [info ] [MainThread]: To view your profiles.yml file, run:

start C:\Users\Ruoyu\.dbt
[0m00:25:50.219476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AF9450D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AF9450D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AF9450EB0>]}
[0m00:25:50.219476 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 00:27:10.938948 | 5a259fd4-273f-4d10-81d8-93946d5d4e39 ==============================
[0m00:27:10.938948 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:27:10.939950 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:27:10.939950 [debug] [MainThread]: Tracking: tracking
[0m00:27:10.939950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D712C820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D712C8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D712C8B0>]}
[0m00:27:10.947949 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m00:27:10.947949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5a259fd4-273f-4d10-81d8-93946d5d4e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D713B6A0>]}
[0m00:27:11.003950 [debug] [MainThread]: Parsing macros\adapters.sql
[0m00:27:11.021948 [debug] [MainThread]: Parsing macros\catalog.sql
[0m00:27:11.025948 [debug] [MainThread]: Parsing macros\etc.sql
[0m00:27:11.026948 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m00:27:11.028948 [debug] [MainThread]: Parsing macros\materializations\copy.sql
[0m00:27:11.030948 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
[0m00:27:11.043948 [debug] [MainThread]: Parsing macros\materializations\seed.sql
[0m00:27:11.045949 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
[0m00:27:11.046948 [debug] [MainThread]: Parsing macros\materializations\table.sql
[0m00:27:11.052949 [debug] [MainThread]: Parsing macros\materializations\view.sql
[0m00:27:11.054948 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m00:27:11.054948 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m00:27:11.054948 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m00:27:11.055948 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m00:27:11.055948 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m00:27:11.056948 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m00:27:11.057948 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m00:27:11.057948 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m00:27:11.058948 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m00:27:11.058948 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m00:27:11.058948 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m00:27:11.058948 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m00:27:11.059948 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m00:27:11.060948 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m00:27:11.060948 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m00:27:11.060948 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m00:27:11.061948 [debug] [MainThread]: Parsing macros\utils\timestamps.sql
[0m00:27:11.062948 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m00:27:11.072948 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m00:27:11.079947 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m00:27:11.080948 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m00:27:11.082948 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m00:27:11.087948 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m00:27:11.091949 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m00:27:11.101948 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m00:27:11.103948 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m00:27:11.105948 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m00:27:11.111948 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m00:27:11.115951 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m00:27:11.116948 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m00:27:11.117948 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m00:27:11.117948 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m00:27:11.118948 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m00:27:11.119948 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m00:27:11.120947 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m00:27:11.122948 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m00:27:11.123947 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m00:27:11.126948 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m00:27:11.132948 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m00:27:11.140948 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m00:27:11.141947 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m00:27:11.151948 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m00:27:11.163949 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m00:27:11.168948 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m00:27:11.171948 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m00:27:11.175948 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m00:27:11.177948 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m00:27:11.179948 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m00:27:11.180948 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m00:27:11.184947 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m00:27:11.197948 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m00:27:11.202947 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m00:27:11.211948 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m00:27:11.219948 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m00:27:11.221947 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m00:27:11.232947 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m00:27:11.234947 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m00:27:11.237948 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m00:27:11.238948 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m00:27:11.243947 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m00:27:11.243947 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m00:27:11.244948 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m00:27:11.245948 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m00:27:11.246948 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m00:27:11.247948 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m00:27:11.247948 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m00:27:11.248947 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m00:27:11.253948 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m00:27:11.254948 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m00:27:11.255947 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m00:27:11.255947 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m00:27:11.256947 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m00:27:11.257948 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m00:27:11.258947 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m00:27:11.258947 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m00:27:11.259947 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m00:27:11.260947 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m00:27:11.262948 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m00:27:11.263947 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m00:27:11.263947 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m00:27:11.264947 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m00:27:11.265948 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m00:27:11.266948 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m00:27:11.267948 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m00:27:11.481950 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m00:27:11.489948 [debug] [MainThread]: 1699: static parser successfully parsed views\latest_cadjpy.sql
[0m00:27:11.491948 [debug] [MainThread]: 1699: static parser successfully parsed views\product_japanese.sql
[0m00:27:11.534947 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m00:27:11.538951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a259fd4-273f-4d10-81d8-93946d5d4e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D73940D0>]}
[0m00:27:11.544949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a259fd4-273f-4d10-81d8-93946d5d4e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D713B6D0>]}
[0m00:27:11.545950 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m00:27:11.545950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a259fd4-273f-4d10-81d8-93946d5d4e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D7394F70>]}
[0m00:27:11.546948 [info ] [MainThread]: 
[0m00:27:11.546948 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:27:11.547948 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m00:27:11.548948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:12.183181 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m00:27:12.184181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:12.672179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a259fd4-273f-4d10-81d8-93946d5d4e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D71E6A60>]}
[0m00:27:12.673180 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:27:12.674178 [info ] [MainThread]: 
[0m00:27:12.678180 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m00:27:12.679181 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m00:27:12.680182 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m00:27:12.680182 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m00:27:12.680182 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m00:27:12.684178 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m00:27:12.686179 [debug] [Thread-1  ]: finished collecting timing info
[0m00:27:12.686179 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m00:27:12.716177 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m00:27:12.717179 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:27:12.718178 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        'Guess' as brand,
        size,
        color,
        LEFT(old_price, 1) as old_price,
        LEFT(new_price, 1) as new_price,
        old_price * rates.rate as old_price_jpy,
        new_price * rates.rate as new_price_jpy,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
    left join rates
    on rates.rate_id = guess_data.echange_rate_id

)
    );
  
[0m00:27:13.306059 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got ")" at [41:5]')
[0m00:27:13.608059 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:us-central1:9e9ae6bd-7832-4c24-be19-4fe7645caee1&page=queryresults
[0m00:27:13.609059 [debug] [Thread-1  ]: finished collecting timing info
[0m00:27:13.609059 [debug] [Thread-1  ]: Database Error in model guess_data_clean (models\views\guess_data_clean.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got ")" at [41:5]
  compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:27:13.610059 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a259fd4-273f-4d10-81d8-93946d5d4e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D74A8D90>]}
[0m00:27:13.610059 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model buyma_ruoyu.guess_data_clean ............. [[31mERROR[0m in 0.93s]
[0m00:27:13.611058 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m00:27:13.612058 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:27:13.612058 [info ] [MainThread]: 
[0m00:27:13.613058 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m00:27:13.613058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:27:13.613058 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m00:27:13.613058 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m00:27:13.613058 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m00:27:13.619058 [info ] [MainThread]: 
[0m00:27:13.619058 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:27:13.620058 [info ] [MainThread]: 
[0m00:27:13.620058 [error] [MainThread]: [33mDatabase Error in model guess_data_clean (models\views\guess_data_clean.sql)[0m
[0m00:27:13.621058 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got ")" at [41:5]
[0m00:27:13.621058 [error] [MainThread]:   compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:27:13.622059 [info ] [MainThread]: 
[0m00:27:13.622059 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:27:13.623058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D73940D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D7394B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D74DEC40>]}
[0m00:27:13.623058 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 00:28:16.087306 | e1d79efe-3a63-413c-acc6-ecbe0e2d7ab9 ==============================
[0m00:28:16.087306 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:28:16.088306 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:28:16.088306 [debug] [MainThread]: Tracking: tracking
[0m00:28:16.089306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DF4EB7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DF4EB8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DF4EB880>]}
[0m00:28:16.147306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:28:16.147306 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m00:28:16.157307 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m00:28:16.176307 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m00:28:16.181307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1d79efe-3a63-413c-acc6-ecbe0e2d7ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DF6602E0>]}
[0m00:28:16.186307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1d79efe-3a63-413c-acc6-ecbe0e2d7ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DF502130>]}
[0m00:28:16.186307 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m00:28:16.187306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1d79efe-3a63-413c-acc6-ecbe0e2d7ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DF502070>]}
[0m00:28:16.187306 [info ] [MainThread]: 
[0m00:28:16.188308 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:28:16.189306 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m00:28:16.189306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:16.706280 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m00:28:16.707285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:17.166978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1d79efe-3a63-413c-acc6-ecbe0e2d7ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DF564DF0>]}
[0m00:28:17.167989 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:28:17.168990 [info ] [MainThread]: 
[0m00:28:17.172979 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m00:28:17.173977 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m00:28:17.174980 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m00:28:17.174980 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m00:28:17.174980 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m00:28:17.178989 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m00:28:17.179990 [debug] [Thread-1  ]: finished collecting timing info
[0m00:28:17.179990 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m00:28:17.209976 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m00:28:17.209976 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:28:17.210976 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        'Guess' as brand,
        size,
        color,
        LEFT(old_price, 1) as old_price,
        LEFT(new_price, 1) as new_price,
        old_price * rates.rate as old_price_jpy,
        new_price * rates.rate as new_price_jpy,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
    left join rates
    on rates.rate_id = guess_data.echange_rate_id

)


select * from guess_data_transform
    );
  
[0m00:28:18.396694 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name echange_rate_id not found inside guess_data at [38:35]')
[0m00:28:20.061535 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:us-central1:a3676990-7974-4eef-876b-7b11897e612e&page=queryresults
[0m00:28:20.062545 [debug] [Thread-1  ]: finished collecting timing info
[0m00:28:20.063544 [debug] [Thread-1  ]: Database Error in model guess_data_clean (models\views\guess_data_clean.sql)
  Name echange_rate_id not found inside guess_data at [38:35]
  compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:28:20.063544 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1d79efe-3a63-413c-acc6-ecbe0e2d7ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DF834520>]}
[0m00:28:20.063544 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model buyma_ruoyu.guess_data_clean ............. [[31mERROR[0m in 2.89s]
[0m00:28:20.064548 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m00:28:20.066544 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:28:20.066544 [info ] [MainThread]: 
[0m00:28:20.067545 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.88 seconds (3.88s).
[0m00:28:20.067545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:20.067545 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m00:28:20.068544 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m00:28:20.068544 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m00:28:20.074544 [info ] [MainThread]: 
[0m00:28:20.075545 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:28:20.075545 [info ] [MainThread]: 
[0m00:28:20.076545 [error] [MainThread]: [33mDatabase Error in model guess_data_clean (models\views\guess_data_clean.sql)[0m
[0m00:28:20.077545 [error] [MainThread]:   Name echange_rate_id not found inside guess_data at [38:35]
[0m00:28:20.077545 [error] [MainThread]:   compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:28:20.077545 [info ] [MainThread]: 
[0m00:28:20.078546 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:28:20.078546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DF87BEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DF87BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DF838520>]}
[0m00:28:20.079546 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 00:28:26.766042 | 1d50f354-99cc-4035-8738-f88d2217d262 ==============================
[0m00:28:26.766042 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:28:26.767042 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:28:26.767042 [debug] [MainThread]: Tracking: tracking
[0m00:28:26.767042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A16E1B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A16E1BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A16E1BB0>]}
[0m00:28:26.829040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:28:26.829040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:28:26.829040 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m00:28:26.835044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d50f354-99cc-4035-8738-f88d2217d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A186F0D0>]}
[0m00:28:26.841044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d50f354-99cc-4035-8738-f88d2217d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A179E070>]}
[0m00:28:26.841044 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m00:28:26.841044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d50f354-99cc-4035-8738-f88d2217d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A1840D30>]}
[0m00:28:26.842042 [info ] [MainThread]: 
[0m00:28:26.843045 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:28:26.844042 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m00:28:26.844042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:27.433696 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m00:28:27.434697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:27.932550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d50f354-99cc-4035-8738-f88d2217d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A16F9490>]}
[0m00:28:27.933551 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:28:27.933551 [info ] [MainThread]: 
[0m00:28:27.938548 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m00:28:27.939549 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m00:28:27.939549 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m00:28:27.939549 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m00:28:27.940552 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m00:28:27.944551 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m00:28:27.944551 [debug] [Thread-1  ]: finished collecting timing info
[0m00:28:27.944551 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m00:28:27.980548 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m00:28:27.980548 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:28:27.981548 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        'Guess' as brand,
        size,
        color,
        LEFT(old_price, 1) as old_price,
        LEFT(new_price, 1) as new_price,
        old_price * rates.rate as old_price_jpy,
        new_price * rates.rate as new_price_jpy,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
    left join rates
    on rates.rate_id = guess_data.echange_rate_id

)


select * from guess_data_transform
    );
  
[0m00:28:28.889348 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name echange_rate_id not found inside guess_data at [38:35]')
[0m00:28:30.262443 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:us-central1:f5e7e576-6e8e-4a1d-b277-26e9ecf60f9b&page=queryresults
[0m00:28:30.263472 [debug] [Thread-1  ]: finished collecting timing info
[0m00:28:30.264463 [debug] [Thread-1  ]: Database Error in model guess_data_clean (models\views\guess_data_clean.sql)
  Name echange_rate_id not found inside guess_data at [38:35]
  compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:28:30.264463 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d50f354-99cc-4035-8738-f88d2217d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A1912EE0>]}
[0m00:28:30.265472 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model buyma_ruoyu.guess_data_clean ............. [[31mERROR[0m in 2.32s]
[0m00:28:30.265472 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m00:28:30.267472 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:28:30.268472 [info ] [MainThread]: 
[0m00:28:30.268472 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.42 seconds (3.42s).
[0m00:28:30.268472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:30.269458 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m00:28:30.269458 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m00:28:30.269458 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m00:28:30.277473 [info ] [MainThread]: 
[0m00:28:30.278468 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:28:30.278468 [info ] [MainThread]: 
[0m00:28:30.278468 [error] [MainThread]: [33mDatabase Error in model guess_data_clean (models\views\guess_data_clean.sql)[0m
[0m00:28:30.279468 [error] [MainThread]:   Name echange_rate_id not found inside guess_data at [38:35]
[0m00:28:30.279468 [error] [MainThread]:   compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:28:30.279468 [info ] [MainThread]: 
[0m00:28:30.280466 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:28:30.280466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A1840970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A1840A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A1957100>]}
[0m00:28:30.280466 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 00:30:23.867353 | 2a5caa58-b531-4a56-9cda-e413625764a6 ==============================
[0m00:30:23.867353 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:30:23.868353 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:30:23.868353 [debug] [MainThread]: Tracking: tracking
[0m00:30:23.868353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002914DFEB7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002914DFEB880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002914DFEB850>]}
[0m00:30:23.927354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:30:23.927354 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m00:30:23.938355 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m00:30:23.957354 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m00:30:23.962355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a5caa58-b531-4a56-9cda-e413625764a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002914E160B50>]}
[0m00:30:23.969356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a5caa58-b531-4a56-9cda-e413625764a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002914E0029A0>]}
[0m00:30:23.969356 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m00:30:23.969356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a5caa58-b531-4a56-9cda-e413625764a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002914E002A60>]}
[0m00:30:23.971356 [info ] [MainThread]: 
[0m00:30:23.971356 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:30:23.972356 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m00:30:23.972356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:30:24.506322 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m00:30:24.506322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:30:24.940117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a5caa58-b531-4a56-9cda-e413625764a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002914E064D30>]}
[0m00:30:24.940117 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:30:24.941115 [info ] [MainThread]: 
[0m00:30:24.945116 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m00:30:24.945116 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m00:30:24.946117 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m00:30:24.946117 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m00:30:24.946117 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m00:30:24.949116 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m00:30:24.949116 [debug] [Thread-1  ]: finished collecting timing info
[0m00:30:24.950117 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m00:30:24.981117 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m00:30:24.981117 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:30:24.982116 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        'Guess' as brand,
        size,
        color,
        LEFT(old_price, 1) as old_price,
        LEFT(new_price, 1) as new_price,
        old_price * rates.rate as old_price_jpy,
        new_price * rates.rate as new_price_jpy,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),

final as (
    select 
        *,
        current_timestamp as dbt_updated_at
    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data.echange_rate_id

) 

select * from final
    );
  
[0m00:30:25.843428 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: rates; Did you mean name? at [29:21]')
[0m00:30:28.673165 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:us-central1:8e89b49a-5875-4237-85c6-95f777397fdb&page=queryresults
[0m00:30:28.674165 [debug] [Thread-1  ]: finished collecting timing info
[0m00:30:28.675165 [debug] [Thread-1  ]: Database Error in model guess_data_clean (models\views\guess_data_clean.sql)
  Unrecognized name: rates; Did you mean name? at [29:21]
  compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:30:28.675165 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a5caa58-b531-4a56-9cda-e413625764a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002914E2F15B0>]}
[0m00:30:28.675165 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model buyma_ruoyu.guess_data_clean ............. [[31mERROR[0m in 3.73s]
[0m00:30:28.676165 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m00:30:28.677167 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:30:28.677167 [info ] [MainThread]: 
[0m00:30:28.678165 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.71 seconds (4.71s).
[0m00:30:28.678165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:30:28.678165 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m00:30:28.678165 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m00:30:28.678165 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m00:30:28.684167 [info ] [MainThread]: 
[0m00:30:28.684167 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:30:28.685167 [info ] [MainThread]: 
[0m00:30:28.685167 [error] [MainThread]: [33mDatabase Error in model guess_data_clean (models\views\guess_data_clean.sql)[0m
[0m00:30:28.686170 [error] [MainThread]:   Unrecognized name: rates; Did you mean name? at [29:21]
[0m00:30:28.686170 [error] [MainThread]:   compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:30:28.686170 [info ] [MainThread]: 
[0m00:30:28.687169 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:30:28.687169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002914E37AD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002914E37AC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002914E33C070>]}
[0m00:30:28.687169 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 00:31:46.118174 | 4943e82f-a73c-4ce6-96aa-1cb2b3f515bb ==============================
[0m00:31:46.118174 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:31:46.119176 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:31:46.119176 [debug] [MainThread]: Tracking: tracking
[0m00:31:46.119176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB342B970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB342BA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB342BA00>]}
[0m00:31:46.177174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:31:46.177174 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m00:31:46.187174 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m00:31:46.205174 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m00:31:46.211178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4943e82f-a73c-4ce6-96aa-1cb2b3f515bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB35A5520>]}
[0m00:31:46.216175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4943e82f-a73c-4ce6-96aa-1cb2b3f515bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB34A4F40>]}
[0m00:31:46.216175 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m00:31:46.217176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4943e82f-a73c-4ce6-96aa-1cb2b3f515bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB34A4EB0>]}
[0m00:31:46.218175 [info ] [MainThread]: 
[0m00:31:46.218175 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:31:46.219175 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m00:31:46.219175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:46.791821 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m00:31:46.791821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:47.284751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4943e82f-a73c-4ce6-96aa-1cb2b3f515bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB343BA30>]}
[0m00:31:47.285756 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:31:47.286236 [info ] [MainThread]: 
[0m00:31:47.291252 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m00:31:47.291252 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m00:31:47.292265 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m00:31:47.292265 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m00:31:47.293254 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m00:31:47.297254 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m00:31:47.297254 [debug] [Thread-1  ]: finished collecting timing info
[0m00:31:47.298250 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m00:31:47.331249 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m00:31:47.332250 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:31:47.333250 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        'Guess' as brand,
        size,
        color,
        LEFT(old_price, 1) as old_price,
        LEFT(new_price, 1) as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),

final as (
    select 
        id,
        brand,
        size,
        color,
        old_price * rates.rate as old_price_jpy,
        new_price * rates.rate as new_price_jpy,
        name,
        description,
        image_str,
        current_timestamp as dbt_updated_at
        
    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data.echange_rate_id

) 

select * from final
    );
  
[0m00:31:48.296315 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: guess_data at [52:24]')
[0m00:31:50.508838 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:us-central1:69a96912-462c-45a3-a7e8-16a1179f5845&page=queryresults
[0m00:31:50.509838 [debug] [Thread-1  ]: finished collecting timing info
[0m00:31:50.509838 [debug] [Thread-1  ]: Database Error in model guess_data_clean (models\views\guess_data_clean.sql)
  Unrecognized name: guess_data at [52:24]
  compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:31:50.509838 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4943e82f-a73c-4ce6-96aa-1cb2b3f515bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB3774130>]}
[0m00:31:50.509838 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model buyma_ruoyu.guess_data_clean ............. [[31mERROR[0m in 3.22s]
[0m00:31:50.510838 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m00:31:50.511837 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:31:50.512838 [info ] [MainThread]: 
[0m00:31:50.512838 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.29 seconds (4.29s).
[0m00:31:50.512838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:50.513840 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m00:31:50.513840 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m00:31:50.513840 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m00:31:50.518839 [info ] [MainThread]: 
[0m00:31:50.518839 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:31:50.519839 [info ] [MainThread]: 
[0m00:31:50.519839 [error] [MainThread]: [33mDatabase Error in model guess_data_clean (models\views\guess_data_clean.sql)[0m
[0m00:31:50.520838 [error] [MainThread]:   Unrecognized name: guess_data at [52:24]
[0m00:31:50.520838 [error] [MainThread]:   compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:31:50.520838 [info ] [MainThread]: 
[0m00:31:50.520838 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:31:50.521839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E8F069D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB35A56A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB37792E0>]}
[0m00:31:50.521839 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 00:32:23.563682 | 8ebc9259-524f-4c9c-85cb-b72a870ed6c0 ==============================
[0m00:32:23.563682 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:32:23.563682 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:32:23.563682 [debug] [MainThread]: Tracking: tracking
[0m00:32:23.564686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AE0DA1D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AE0DA1E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AE0DA1E20>]}
[0m00:32:23.622682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:32:23.622682 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m00:32:23.632682 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m00:32:23.651683 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m00:32:23.656684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ebc9259-524f-4c9c-85cb-b72a870ed6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AE0F22100>]}
[0m00:32:23.662682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ebc9259-524f-4c9c-85cb-b72a870ed6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AE0E9D070>]}
[0m00:32:23.662682 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m00:32:23.663685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ebc9259-524f-4c9c-85cb-b72a870ed6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AE0DC2100>]}
[0m00:32:23.664683 [info ] [MainThread]: 
[0m00:32:23.664683 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:32:23.665683 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m00:32:23.665683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:32:24.139582 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m00:32:24.140581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:32:24.614405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ebc9259-524f-4c9c-85cb-b72a870ed6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AE0E600A0>]}
[0m00:32:24.615404 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:32:24.615404 [info ] [MainThread]: 
[0m00:32:24.620405 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m00:32:24.620405 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m00:32:24.621407 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m00:32:24.621407 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m00:32:24.621407 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m00:32:24.624405 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m00:32:24.625404 [debug] [Thread-1  ]: finished collecting timing info
[0m00:32:24.625404 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m00:32:24.654404 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m00:32:24.655404 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:32:24.656405 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        'Guess' as brand,
        size,
        color,
        LEFT(old_price, 1) as old_price,
        LEFT(new_price, 1) as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),

final as (
    select 
        id,
        brand,
        size,
        color,
        old_price * rates.rate as old_price_jpy,
        new_price * rates.rate as new_price_jpy,
        name,
        description,
        image_str,
        current_timestamp as dbt_updated_at

    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data_transform.echange_rate_id

) 

select * from final
    );
  
[0m00:32:25.502990 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator * for argument types: STRING, FLOAT64. Supported signatures: INT64 * INT64; FLOAT64 * FLOAT64; NUMERIC * NUMERIC; BIGNUMERIC * BIGNUMERIC; INTERVAL * INT64; INT64 * INTERVAL at [43:9]')
[0m00:32:27.049244 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:us-central1:0a15e116-00da-4e01-ae8e-2f84600b3b0d&page=queryresults
[0m00:32:27.050246 [debug] [Thread-1  ]: finished collecting timing info
[0m00:32:27.050246 [debug] [Thread-1  ]: Database Error in model guess_data_clean (models\views\guess_data_clean.sql)
  No matching signature for operator * for argument types: STRING, FLOAT64. Supported signatures: INT64 * INT64; FLOAT64 * FLOAT64; NUMERIC * NUMERIC; BIGNUMERIC * BIGNUMERIC; INTERVAL * INT64; INT64 * INTERVAL at [43:9]
  compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:32:27.051244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ebc9259-524f-4c9c-85cb-b72a870ed6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AE10C7280>]}
[0m00:32:27.051244 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model buyma_ruoyu.guess_data_clean ............. [[31mERROR[0m in 2.43s]
[0m00:32:27.051244 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m00:32:27.053247 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:32:27.053247 [info ] [MainThread]: 
[0m00:32:27.053247 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m00:32:27.054246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:32:27.054246 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m00:32:27.054246 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m00:32:27.054246 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m00:32:27.059246 [info ] [MainThread]: 
[0m00:32:27.060245 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:32:27.060245 [info ] [MainThread]: 
[0m00:32:27.060245 [error] [MainThread]: [33mDatabase Error in model guess_data_clean (models\views\guess_data_clean.sql)[0m
[0m00:32:27.061244 [error] [MainThread]:   No matching signature for operator * for argument types: STRING, FLOAT64. Supported signatures: INT64 * INT64; FLOAT64 * FLOAT64; NUMERIC * NUMERIC; BIGNUMERIC * BIGNUMERIC; INTERVAL * INT64; INT64 * INTERVAL at [43:9]
[0m00:32:27.061244 [error] [MainThread]:   compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:32:27.061244 [info ] [MainThread]: 
[0m00:32:27.061244 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:32:27.062246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AE10BD2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AE1145220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AE10F9790>]}
[0m00:32:27.062246 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 00:33:16.489629 | 4f989e0b-e75b-478b-9fc5-c00e98cbb34f ==============================
[0m00:33:16.489629 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:16.490630 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:33:16.490630 [debug] [MainThread]: Tracking: tracking
[0m00:33:16.490630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BD15C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BD15C4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BD15C4C0>]}
[0m00:33:16.548629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:33:16.549629 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m00:33:16.559631 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m00:33:16.577630 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m00:33:16.582631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f989e0b-e75b-478b-9fc5-c00e98cbb34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BD2C8EB0>]}
[0m00:33:16.587629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f989e0b-e75b-478b-9fc5-c00e98cbb34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BD15C760>]}
[0m00:33:16.587629 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m00:33:16.588631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f989e0b-e75b-478b-9fc5-c00e98cbb34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BD15C970>]}
[0m00:33:16.588631 [info ] [MainThread]: 
[0m00:33:16.589631 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:33:16.590630 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m00:33:16.590630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:17.087218 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m00:33:17.088230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:17.525449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f989e0b-e75b-478b-9fc5-c00e98cbb34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BD21F100>]}
[0m00:33:17.526449 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:33:17.526449 [info ] [MainThread]: 
[0m00:33:17.530446 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m00:33:17.530446 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m00:33:17.531447 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m00:33:17.531447 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m00:33:17.531447 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m00:33:17.534448 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m00:33:17.534448 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:17.534448 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m00:33:17.564446 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m00:33:17.565446 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:33:17.566446 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        'Guess' as brand,
        size,
        color,
        LEFT(old_price, 1) as old_price,
        LEFT(new_price, 1) as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),

final as (
    select 
        id,
        brand,
        size,
        color,
        cast(old_price as float) * rates.rate as old_price_jpy,
        cast(new_price as float) * rates.rate as new_price_jpy,
        name,
        description,
        image_str,
        current_timestamp as dbt_updated_at

    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data_transform.echange_rate_id

) 

select * from final
    );
  
[0m00:33:18.433542 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Type not found: float at [43:27]')
[0m00:33:19.796010 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:us-central1:b41c593a-711c-4dcb-91ce-86c8552384f2&page=queryresults
[0m00:33:19.797322 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:19.797322 [debug] [Thread-1  ]: Database Error in model guess_data_clean (models\views\guess_data_clean.sql)
  Type not found: float at [43:27]
  compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:33:19.798351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f989e0b-e75b-478b-9fc5-c00e98cbb34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BD49C6D0>]}
[0m00:33:19.798351 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model buyma_ruoyu.guess_data_clean ............. [[31mERROR[0m in 2.27s]
[0m00:33:19.799335 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m00:33:19.800349 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:33:19.801349 [info ] [MainThread]: 
[0m00:33:19.802336 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m00:33:19.802336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:19.802336 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m00:33:19.802336 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m00:33:19.802336 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m00:33:19.810349 [info ] [MainThread]: 
[0m00:33:19.810349 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:33:19.811349 [info ] [MainThread]: 
[0m00:33:19.811349 [error] [MainThread]: [33mDatabase Error in model guess_data_clean (models\views\guess_data_clean.sql)[0m
[0m00:33:19.812349 [error] [MainThread]:   Type not found: float at [43:27]
[0m00:33:19.812349 [error] [MainThread]:   compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:33:19.813349 [info ] [MainThread]: 
[0m00:33:19.813349 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:33:19.814336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BD4ECA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BD4EC970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BD476A00>]}
[0m00:33:19.814336 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 00:34:28.625209 | 787363c1-f4ca-4e43-8575-91bd74ee51f3 ==============================
[0m00:34:28.625209 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:34:28.626211 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:34:28.626211 [debug] [MainThread]: Tracking: tracking
[0m00:34:28.626211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF7211B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF7211C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF7211C10>]}
[0m00:34:28.684210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:34:28.684210 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m00:34:28.694209 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m00:34:28.713209 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m00:34:28.718210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '787363c1-f4ca-4e43-8575-91bd74ee51f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF7394C10>]}
[0m00:34:28.724209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '787363c1-f4ca-4e43-8575-91bd74ee51f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF7370D90>]}
[0m00:34:28.724209 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m00:34:28.725209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '787363c1-f4ca-4e43-8575-91bd74ee51f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF7370D30>]}
[0m00:34:28.726209 [info ] [MainThread]: 
[0m00:34:28.726209 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:34:28.727209 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m00:34:28.727209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:29.226541 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m00:34:29.226541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:29.663417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '787363c1-f4ca-4e43-8575-91bd74ee51f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF7229FD0>]}
[0m00:34:29.663417 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:34:29.664415 [info ] [MainThread]: 
[0m00:34:29.667416 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m00:34:29.667416 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m00:34:29.668416 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m00:34:29.668416 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m00:34:29.668416 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m00:34:29.671418 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m00:34:29.672417 [debug] [Thread-1  ]: finished collecting timing info
[0m00:34:29.672417 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m00:34:29.701416 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m00:34:29.702416 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:34:29.703417 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        'Guess' as brand,
        size,
        color,
        LEFT(old_price, 1) as old_price,
        LEFT(new_price, 1) as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),

final as (
    select 
        id,
        brand,
        size,
        color,
        cast(old_price as FLOAT64) * rates.rate as old_price_jpy,
        cast(new_price as FLOAT64) * rates.rate as new_price_jpy,
        name,
        description,
        image_str,
        current_timestamp as dbt_updated_at

    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data_transform.echange_rate_id

) 

select * from final
    );
  
[0m00:34:30.883536 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Bad double value: ')
[0m00:34:33.518745 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:us-central1:27a4bf6b-60f1-4ce7-a470-c5e43d88b354&page=queryresults
[0m00:34:33.518745 [debug] [Thread-1  ]: finished collecting timing info
[0m00:34:33.519747 [debug] [Thread-1  ]: Database Error in model guess_data_clean (models\views\guess_data_clean.sql)
  Bad double value: 
  compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:34:33.519747 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '787363c1-f4ca-4e43-8575-91bd74ee51f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF75DDD00>]}
[0m00:34:33.520746 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model buyma_ruoyu.guess_data_clean ............. [[31mERROR[0m in 3.85s]
[0m00:34:33.520746 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m00:34:33.522745 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:34:33.522745 [info ] [MainThread]: 
[0m00:34:33.522745 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.80 seconds (4.80s).
[0m00:34:33.523746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:33.523746 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m00:34:33.523746 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m00:34:33.523746 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m00:34:33.530787 [info ] [MainThread]: 
[0m00:34:33.530787 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:34:33.531789 [info ] [MainThread]: 
[0m00:34:33.531789 [error] [MainThread]: [33mDatabase Error in model guess_data_clean (models\views\guess_data_clean.sql)[0m
[0m00:34:33.531789 [error] [MainThread]:   Bad double value: 
[0m00:34:33.532785 [error] [MainThread]:   compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:34:33.532785 [info ] [MainThread]: 
[0m00:34:33.533784 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:34:33.533784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF75AB6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF75B41F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF75BE670>]}
[0m00:34:33.533784 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 00:37:15.685631 | b70bc697-de6c-4a53-9b77-a17ec876c0d7 ==============================
[0m00:37:15.685631 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:37:15.685631 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:37:15.686631 [debug] [MainThread]: Tracking: tracking
[0m00:37:15.686631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D404E3E5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D404E3E6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D404E3E670>]}
[0m00:37:15.747631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:37:15.747631 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m00:37:15.757632 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m00:37:15.776631 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m00:37:15.781632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b70bc697-de6c-4a53-9b77-a17ec876c0d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D404FB10D0>]}
[0m00:37:15.787631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b70bc697-de6c-4a53-9b77-a17ec876c0d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D404E52640>]}
[0m00:37:15.787631 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m00:37:15.787631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70bc697-de6c-4a53-9b77-a17ec876c0d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D404E52970>]}
[0m00:37:15.788631 [info ] [MainThread]: 
[0m00:37:15.789631 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:37:15.790632 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m00:37:15.790632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:16.725206 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m00:37:16.726206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:17.155657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70bc697-de6c-4a53-9b77-a17ec876c0d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D404EA1190>]}
[0m00:37:17.155657 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:37:17.156655 [info ] [MainThread]: 
[0m00:37:17.159653 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m00:37:17.159653 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m00:37:17.160657 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m00:37:17.160657 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m00:37:17.160657 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m00:37:17.163668 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m00:37:17.164655 [debug] [Thread-1  ]: finished collecting timing info
[0m00:37:17.164655 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m00:37:17.195653 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m00:37:17.196655 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:37:17.197653 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        'Guess' as brand,
        size,
        color,
        ifnull(LEFT(old_price, 1),'0') as old_price,
        ifnull(LEFT(new_price, 1),'0') as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),

final as (
    select 
        id,
        brand,
        size,
        color,
        cast(old_price as FLOAT64) * rates.rate as old_price_jpy,
        cast(new_price as FLOAT64) * rates.rate as new_price_jpy,
        name,
        description,
        image_str,
        current_timestamp as dbt_updated_at

    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data_transform.echange_rate_id

) 

select * from final
    );
  
[0m00:37:18.373834 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Bad double value: ')
[0m00:37:19.439663 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:us-central1:ed721937-ee95-491e-a9ec-23f47e1815b9&page=queryresults
[0m00:37:19.440689 [debug] [Thread-1  ]: finished collecting timing info
[0m00:37:19.441689 [debug] [Thread-1  ]: Database Error in model guess_data_clean (models\views\guess_data_clean.sql)
  Bad double value: 
  compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:37:19.441689 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70bc697-de6c-4a53-9b77-a17ec876c0d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D405141580>]}
[0m00:37:19.441689 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model buyma_ruoyu.guess_data_clean ............. [[31mERROR[0m in 2.28s]
[0m00:37:19.442689 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m00:37:19.444689 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:37:19.444689 [info ] [MainThread]: 
[0m00:37:19.445689 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.66 seconds (3.66s).
[0m00:37:19.445689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:19.445689 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m00:37:19.445689 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m00:37:19.445689 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m00:37:19.451685 [info ] [MainThread]: 
[0m00:37:19.452685 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:37:19.452685 [info ] [MainThread]: 
[0m00:37:19.453687 [error] [MainThread]: [33mDatabase Error in model guess_data_clean (models\views\guess_data_clean.sql)[0m
[0m00:37:19.453687 [error] [MainThread]:   Bad double value: 
[0m00:37:19.453687 [error] [MainThread]:   compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m00:37:19.454685 [info ] [MainThread]: 
[0m00:37:19.454685 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:37:19.454685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D404FE70D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D404FDE610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4051414F0>]}
[0m00:37:19.454685 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 00:38:10.182404 | a84b24f4-3ee2-4b9a-a0a1-ba1eb8b9e9d2 ==============================
[0m00:38:10.182404 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:38:10.182404 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:38:10.182404 [debug] [MainThread]: Tracking: tracking
[0m00:38:10.183404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D62207B940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D62207BA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D62207B9D0>]}
[0m00:38:10.240446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:38:10.241446 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m00:38:10.251452 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m00:38:10.271446 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m00:38:10.276448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a84b24f4-3ee2-4b9a-a0a1-ba1eb8b9e9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6221F5370>]}
[0m00:38:10.282447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a84b24f4-3ee2-4b9a-a0a1-ba1eb8b9e9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6220F4F10>]}
[0m00:38:10.282447 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m00:38:10.282447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a84b24f4-3ee2-4b9a-a0a1-ba1eb8b9e9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6220F4E80>]}
[0m00:38:10.283446 [info ] [MainThread]: 
[0m00:38:10.284447 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:38:10.285447 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m00:38:10.285447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:10.758721 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m00:38:10.758721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:11.212333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a84b24f4-3ee2-4b9a-a0a1-ba1eb8b9e9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D62208BA60>]}
[0m00:38:11.212333 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:38:11.213335 [info ] [MainThread]: 
[0m00:38:11.218333 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m00:38:11.218333 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m00:38:11.219330 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m00:38:11.219330 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m00:38:11.219330 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m00:38:11.223330 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m00:38:11.224330 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:11.224330 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m00:38:11.254329 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m00:38:11.254329 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:38:11.255330 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        'Guess' as brand,
        size,
        color,
        ifnull(LEFT(old_price, 1),'0') as old_price,
        ifnull(LEFT(new_price, 1),'0') as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),

final as (
    select 
        id,
        brand,
        size,
        color,
        safe_cast(old_price as FLOAT64) * rates.rate as old_price_jpy,
        safe_cast(new_price as FLOAT64) * rates.rate as new_price_jpy,
        name,
        description,
        image_str,
        current_timestamp as dbt_updated_at

    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data_transform.echange_rate_id

) 

select * from final
    );
  
[0m00:38:14.034525 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:51d8c9c3-a809-4a09-b9d9-99638f0b34db:us-central1&page=queryresults
[0m00:38:14.046536 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:14.046536 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a84b24f4-3ee2-4b9a-a0a1-ba1eb8b9e9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D622393DF0>]}
[0m00:38:14.047536 [info ] [Thread-1  ]: 1 of 1 OK created sql table model buyma_ruoyu.guess_data_clean ................. [[32mCREATE TABLE (430.0 rows, 378.0 KB processed)[0m in 2.83s]
[0m00:38:14.048590 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m00:38:14.049538 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m00:38:14.049538 [info ] [MainThread]: 
[0m00:38:14.050538 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m00:38:14.050538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:14.050538 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m00:38:14.050538 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m00:38:14.050538 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m00:38:14.056537 [info ] [MainThread]: 
[0m00:38:14.056537 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:38:14.057538 [info ] [MainThread]: 
[0m00:38:14.058538 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:38:14.058538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6221F5B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DB206D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6223C8D60>]}
[0m00:38:14.058538 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 01:44:36.368361 | 362a3e27-b718-4778-8a76-2ba3160b7a28 ==============================
[0m01:44:36.368361 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:44:36.368361 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:44:36.368361 [debug] [MainThread]: Tracking: tracking
[0m01:44:36.369361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A85678B820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A85678B8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A85678B8B0>]}
[0m01:44:36.428361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:44:36.429361 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m01:44:36.439361 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m01:44:36.459361 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m01:44:36.464361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '362a3e27-b718-4778-8a76-2ba3160b7a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A856902D30>]}
[0m01:44:36.469362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '362a3e27-b718-4778-8a76-2ba3160b7a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A856804DF0>]}
[0m01:44:36.470361 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m01:44:36.470361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '362a3e27-b718-4778-8a76-2ba3160b7a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A856804D60>]}
[0m01:44:36.471361 [info ] [MainThread]: 
[0m01:44:36.471361 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:44:36.472361 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m01:44:36.473361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:37.073399 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m01:44:37.074398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:37.585387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '362a3e27-b718-4778-8a76-2ba3160b7a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8568D9F40>]}
[0m01:44:37.586387 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:44:37.586387 [info ] [MainThread]: 
[0m01:44:37.590387 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m01:44:37.590387 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m01:44:37.591387 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m01:44:37.591387 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m01:44:37.591387 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m01:44:37.594386 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m01:44:37.595387 [debug] [Thread-1  ]: finished collecting timing info
[0m01:44:37.595387 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m01:44:37.607387 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m01:44:38.125384 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m01:44:38.126385 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        url,
        'Guess' as brand,
        size,
        color,
        ifnull(LEFT(old_price, 1),'0') as old_price,
        ifnull(LEFT(new_price, 1),'0') as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),

final as (
    select 
        id,
        url,
        brand,
        size,
        color,
        ROUND(safe_cast(old_price as FLOAT64) * rates.rate, 2) as old_price_jpy,
        ROUND(safe_cast(new_price as FLOAT64) * rates.rate, 2) as new_price_jpy,
        name,
        description,
        image_str,
        current_timestamp as dbt_updated_at

    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data_transform.echange_rate_id

) 

select * from final
    );
  
[0m01:44:40.356847 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:df057cee-cd4a-49b8-ae88-22036b0f990a:us-central1&page=queryresults
[0m01:44:40.373847 [debug] [Thread-1  ]: finished collecting timing info
[0m01:44:40.374847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '362a3e27-b718-4778-8a76-2ba3160b7a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A856AA3EE0>]}
[0m01:44:40.374847 [info ] [Thread-1  ]: 1 of 1 OK created sql table model buyma_ruoyu.guess_data_clean ................. [[32mCREATE TABLE (430.0 rows, 426.7 KB processed)[0m in 2.78s]
[0m01:44:40.375848 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m01:44:40.376848 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:44:40.376848 [info ] [MainThread]: 
[0m01:44:40.377848 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m01:44:40.377848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:44:40.377848 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m01:44:40.377848 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m01:44:40.377848 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m01:44:40.383851 [info ] [MainThread]: 
[0m01:44:40.383851 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:44:40.384847 [info ] [MainThread]: 
[0m01:44:40.384847 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:44:40.384847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A856B26100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8569370D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A856B30CA0>]}
[0m01:44:40.385847 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 02:31:52.947231 | 7116c677-fa5e-4e6a-a3f6-699392ce3410 ==============================
[0m02:31:52.947231 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:31:52.948231 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:31:52.948231 [debug] [MainThread]: Tracking: tracking
[0m02:31:52.948231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8BE761AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8BE761B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8BE761B50>]}
[0m02:31:53.006231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:31:53.006231 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:31:53.007231 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m02:31:53.012232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7116c677-fa5e-4e6a-a3f6-699392ce3410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8BE8EF0D0>]}
[0m02:31:53.018231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7116c677-fa5e-4e6a-a3f6-699392ce3410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8BE8C1CD0>]}
[0m02:31:53.019231 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m02:31:53.019231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7116c677-fa5e-4e6a-a3f6-699392ce3410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8BE8C1C70>]}
[0m02:31:53.020231 [info ] [MainThread]: 
[0m02:31:53.020231 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:31:53.021233 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m02:31:53.022234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:31:53.526741 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m02:31:53.526741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:31:53.989525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7116c677-fa5e-4e6a-a3f6-699392ce3410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8BE779430>]}
[0m02:31:53.990524 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:31:53.990524 [info ] [MainThread]: 
[0m02:31:53.994524 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m02:31:53.994524 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m02:31:53.994524 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m02:31:53.994524 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m02:31:53.995524 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m02:31:53.998525 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m02:31:53.998525 [debug] [Thread-1  ]: finished collecting timing info
[0m02:31:53.999524 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m02:31:54.011524 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:31:54.577836 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m02:31:54.578836 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        url,
        'Guess' as brand,
        size,
        color,
        ifnull(LEFT(old_price, 1),'0') as old_price,
        ifnull(LEFT(new_price, 1),'0') as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),

final as (
    select 
        id,
        url,
        brand,
        size,
        color,
        ROUND(safe_cast(old_price as FLOAT64) * rates.rate, 2) as old_price_jpy,
        ROUND(safe_cast(new_price as FLOAT64) * rates.rate, 2) as new_price_jpy,
        name,
        description,
        image_str,
        current_timestamp as dbt_updated_at

    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data_transform.echange_rate_id

) 

select * from final
    );
  
[0m02:31:57.070614 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:8a7e7239-5817-4d49-a272-c19ecd971a10:us-central1&page=queryresults
[0m02:31:57.085613 [debug] [Thread-1  ]: finished collecting timing info
[0m02:31:57.085613 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7116c677-fa5e-4e6a-a3f6-699392ce3410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8BE954F70>]}
[0m02:31:57.086613 [info ] [Thread-1  ]: 1 of 1 OK created sql table model buyma_ruoyu.guess_data_clean ................. [[32mCREATE TABLE (430.0 rows, 426.7 KB processed)[0m in 3.09s]
[0m02:31:57.087615 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m02:31:57.088614 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:31:57.088614 [info ] [MainThread]: 
[0m02:31:57.089613 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.07 seconds (4.07s).
[0m02:31:57.089613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:31:57.090613 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m02:31:57.090613 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m02:31:57.090613 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m02:31:57.096617 [info ] [MainThread]: 
[0m02:31:57.096617 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:31:57.097615 [info ] [MainThread]: 
[0m02:31:57.097615 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:31:57.098614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8BE94EEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8BE8C1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8BE999E50>]}
[0m02:31:57.098614 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 02:42:54.264096 | eb5f6f0d-22bc-4154-bca2-e542844c6fbe ==============================
[0m02:42:54.264096 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:42:54.265099 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:42:54.265099 [debug] [MainThread]: Tracking: tracking
[0m02:42:54.265099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF229F1AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF229F1BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF229F1B80>]}
[0m02:42:54.325099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:42:54.325099 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m02:42:54.335098 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m02:42:54.354096 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m02:42:54.359097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb5f6f0d-22bc-4154-bca2-e542844c6fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF22B718E0>]}
[0m02:42:54.365096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb5f6f0d-22bc-4154-bca2-e542844c6fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF22B51D00>]}
[0m02:42:54.365096 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m02:42:54.366099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb5f6f0d-22bc-4154-bca2-e542844c6fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF22B51CA0>]}
[0m02:42:54.366099 [info ] [MainThread]: 
[0m02:42:54.367101 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:42:54.368097 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m02:42:54.368097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:54.953585 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m02:42:54.953585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:55.462180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb5f6f0d-22bc-4154-bca2-e542844c6fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF22A09AF0>]}
[0m02:42:55.463178 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:42:55.464175 [info ] [MainThread]: 
[0m02:42:55.467175 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m02:42:55.468176 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m02:42:55.468176 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m02:42:55.468176 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m02:42:55.468176 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m02:42:55.471176 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m02:42:55.472175 [debug] [Thread-1  ]: finished collecting timing info
[0m02:42:55.472175 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m02:42:55.484175 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:42:56.020580 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m02:42:56.021581 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        url,
        'Guess' as brand,
        size,
        color,
        ifnull(REPLACE((old_price,'CAD',''),'0') as old_price,
        ifnull(REPLACE(new_price,'CAD',''),'0') as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),

final as (
    select 
        id,
        url,
        brand,
        size,
        color,
        ROUND(safe_cast(old_price as FLOAT64) * rates.rate,1) as old_price_jpy,
        ROUND(safe_cast(new_price as FLOAT64) * rates.rate,1) as new_price_jpy,
        name,
        description,
        image_str,
        current_timestamp as dbt_updated_at

    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data_transform.echange_rate_id

) 

select * from final
    );
  
[0m02:42:56.247792 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword AS at [28:50]')
[0m02:42:57.066179 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:us-central1:723465c8-a768-45ea-bf96-ee0de076fc2e&page=queryresults
[0m02:42:57.067178 [debug] [Thread-1  ]: finished collecting timing info
[0m02:42:57.067178 [debug] [Thread-1  ]: Database Error in model guess_data_clean (models\views\guess_data_clean.sql)
  Syntax error: Expected ")" but got keyword AS at [28:50]
  compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m02:42:57.067178 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb5f6f0d-22bc-4154-bca2-e542844c6fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF22D51E50>]}
[0m02:42:57.067178 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model buyma_ruoyu.guess_data_clean ............. [[31mERROR[0m in 1.60s]
[0m02:42:57.068177 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m02:42:57.069179 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:42:57.070179 [info ] [MainThread]: 
[0m02:42:57.070179 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m02:42:57.071180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:42:57.071180 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m02:42:57.071180 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m02:42:57.071180 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m02:42:57.077178 [info ] [MainThread]: 
[0m02:42:57.077178 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:42:57.078177 [info ] [MainThread]: 
[0m02:42:57.078177 [error] [MainThread]: [33mDatabase Error in model guess_data_clean (models\views\guess_data_clean.sql)[0m
[0m02:42:57.079179 [error] [MainThread]:   Syntax error: Expected ")" but got keyword AS at [28:50]
[0m02:42:57.079179 [error] [MainThread]:   compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m02:42:57.079179 [info ] [MainThread]: 
[0m02:42:57.080178 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:42:57.080178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF22D0E3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF22B51A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF22D9D3A0>]}
[0m02:42:57.081178 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 02:43:36.897024 | 765ae256-1e78-449c-9ffd-2e3d582844ee ==============================
[0m02:43:36.897024 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:43:36.898024 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:43:36.898024 [debug] [MainThread]: Tracking: tracking
[0m02:43:36.898024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531CE2D460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531CE2D520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531CE2D4F0>]}
[0m02:43:36.959024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:43:36.959024 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m02:43:36.969024 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m02:43:36.989024 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m02:43:36.993023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '765ae256-1e78-449c-9ffd-2e3d582844ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531CFA50D0>]}
[0m02:43:36.998023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '765ae256-1e78-449c-9ffd-2e3d582844ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531CE439A0>]}
[0m02:43:36.999024 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m02:43:36.999024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '765ae256-1e78-449c-9ffd-2e3d582844ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531CE43820>]}
[0m02:43:37.000024 [info ] [MainThread]: 
[0m02:43:37.000024 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:43:37.001024 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m02:43:37.001024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:37.489688 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m02:43:37.489688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:37.967371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '765ae256-1e78-449c-9ffd-2e3d582844ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531CEB5280>]}
[0m02:43:37.968370 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:43:37.969373 [info ] [MainThread]: 
[0m02:43:37.973373 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m02:43:37.973373 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m02:43:37.974373 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m02:43:37.974373 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m02:43:37.974373 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m02:43:37.977370 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m02:43:37.977370 [debug] [Thread-1  ]: finished collecting timing info
[0m02:43:37.977370 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m02:43:37.989369 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:43:38.531828 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m02:43:38.532827 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        url,
        'Guess' as brand,
        size,
        color,
        ifnull(REPLACE(old_price,'CAD',''),'0') as old_price,
        ifnull(REPLACE(new_price,'CAD',''),'0') as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),

final as (
    select 
        id,
        url,
        brand,
        size,
        color,
        ROUND(safe_cast(old_price as FLOAT64) * rates.rate,1) as old_price_jpy,
        ROUND(safe_cast(new_price as FLOAT64) * rates.rate,1) as new_price_jpy,
        name,
        description,
        image_str,
        current_timestamp as dbt_updated_at

    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data_transform.echange_rate_id

) 

select * from final
    );
  
[0m02:43:41.005312 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:1c6959bb-eadf-4383-ae0f-8dc5b9cae0e9:us-central1&page=queryresults
[0m02:43:41.023320 [debug] [Thread-1  ]: finished collecting timing info
[0m02:43:41.024320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '765ae256-1e78-449c-9ffd-2e3d582844ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531D142F10>]}
[0m02:43:41.024320 [info ] [Thread-1  ]: 1 of 1 OK created sql table model buyma_ruoyu.guess_data_clean ................. [[32mCREATE TABLE (430.0 rows, 426.7 KB processed)[0m in 3.05s]
[0m02:43:41.025320 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m02:43:41.026320 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:43:41.027324 [info ] [MainThread]: 
[0m02:43:41.027324 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m02:43:41.028321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:43:41.028321 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m02:43:41.028321 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m02:43:41.028321 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m02:43:41.034324 [info ] [MainThread]: 
[0m02:43:41.035322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:43:41.036321 [info ] [MainThread]: 
[0m02:43:41.036321 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:43:41.036321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531D1BBC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531D1BBB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531D1C6F10>]}
[0m02:43:41.037320 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 02:49:30.611065 | 85ddf395-6c59-4e66-9edb-b61d678fb7d1 ==============================
[0m02:49:30.611065 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:49:30.611065 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:49:30.612066 [debug] [MainThread]: Tracking: tracking
[0m02:49:30.612066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A92BB880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A92BB940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A92BB910>]}
[0m02:49:30.673110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:49:30.673110 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m02:49:30.684110 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m02:49:30.703110 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m02:49:30.707110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85ddf395-6c59-4e66-9edb-b61d678fb7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A9435850>]}
[0m02:49:30.713110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85ddf395-6c59-4e66-9edb-b61d678fb7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A9326E50>]}
[0m02:49:30.714109 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m02:49:30.714109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85ddf395-6c59-4e66-9edb-b61d678fb7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A9326DC0>]}
[0m02:49:30.715115 [info ] [MainThread]: 
[0m02:49:30.716110 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:49:30.717110 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m02:49:30.717110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:49:31.268802 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m02:49:31.268802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:49:31.702609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85ddf395-6c59-4e66-9edb-b61d678fb7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A9409FA0>]}
[0m02:49:31.703616 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:49:31.703616 [info ] [MainThread]: 
[0m02:49:31.707987 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m02:49:31.707987 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m02:49:31.708603 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m02:49:31.708603 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m02:49:31.708603 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m02:49:31.711612 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m02:49:31.712613 [debug] [Thread-1  ]: finished collecting timing info
[0m02:49:31.712613 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m02:49:31.724612 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:49:32.250698 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m02:49:32.251696 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        url,
        'Guess' as brand,
        size,
        color,
        ifnull(REPLACE(old_price,'CAD',''),'0') as old_price,
        ifnull(REPLACE(new_price,'CAD',''),'0') as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),

final as (
    select 
        id,
        url,
        brand,
        size,
        color,
        ROUND(safe_cast(old_price as FLOAT64) * rates.rate,1) as old_price_jpy,
        ROUND(safe_cast(new_price as FLOAT64) * rates.rate,1) as new_price_jpy,
        name,
        description,
        image_str,
        SPLIT(image_str,'|')[0] AS Thumbnail,
        current_timestamp as dbt_updated_at

    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data_transform.echange_rate_id

) 

select * from final
    );
  
[0m02:49:32.880961 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Array element access with array[position] is not supported. Use array[OFFSET(zero_based_offset)] or array[ORDINAL(one_based_ordinal)] at [50:30]')
[0m02:49:33.524240 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:us-central1:997a61d1-c3b4-4715-afd7-e6fe0d550f8c&page=queryresults
[0m02:49:33.525239 [debug] [Thread-1  ]: finished collecting timing info
[0m02:49:33.525239 [debug] [Thread-1  ]: Database Error in model guess_data_clean (models\views\guess_data_clean.sql)
  Array element access with array[position] is not supported. Use array[OFFSET(zero_based_offset)] or array[ORDINAL(one_based_ordinal)] at [50:30]
  compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m02:49:33.526240 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85ddf395-6c59-4e66-9edb-b61d678fb7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A95D5B50>]}
[0m02:49:33.526240 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model buyma_ruoyu.guess_data_clean ............. [[31mERROR[0m in 1.82s]
[0m02:49:33.527240 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m02:49:33.528240 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:49:33.528240 [info ] [MainThread]: 
[0m02:49:33.529240 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m02:49:33.529240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:49:33.529240 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m02:49:33.529240 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m02:49:33.529240 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m02:49:33.535240 [info ] [MainThread]: 
[0m02:49:33.536239 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:49:33.536239 [info ] [MainThread]: 
[0m02:49:33.537240 [error] [MainThread]: [33mDatabase Error in model guess_data_clean (models\views\guess_data_clean.sql)[0m
[0m02:49:33.537240 [error] [MainThread]:   Array element access with array[position] is not supported. Use array[OFFSET(zero_based_offset)] or array[ORDINAL(one_based_ordinal)] at [50:30]
[0m02:49:33.538241 [error] [MainThread]:   compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m02:49:33.538241 [info ] [MainThread]: 
[0m02:49:33.539241 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:49:33.539241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A96570D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A93268E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A9660D00>]}
[0m02:49:33.539241 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 02:51:04.964592 | 6494eebc-493f-4163-a1ad-c7505e1a6048 ==============================
[0m02:51:04.964592 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:51:04.965591 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:51:04.965591 [debug] [MainThread]: Tracking: tracking
[0m02:51:04.965591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE5411AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE5411B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE5411B50>]}
[0m02:51:05.024591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:51:05.024591 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m02:51:05.035594 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m02:51:05.054592 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m02:51:05.059594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6494eebc-493f-4163-a1ad-c7505e1a6048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE5590AF0>]}
[0m02:51:05.065595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6494eebc-493f-4163-a1ad-c7505e1a6048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE5570CD0>]}
[0m02:51:05.065595 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m02:51:05.066594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6494eebc-493f-4163-a1ad-c7505e1a6048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE5570C70>]}
[0m02:51:05.067591 [info ] [MainThread]: 
[0m02:51:05.068592 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:51:05.069592 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m02:51:05.069592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:51:05.659656 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m02:51:05.659656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:51:06.157259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6494eebc-493f-4163-a1ad-c7505e1a6048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE5429D00>]}
[0m02:51:06.157259 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:51:06.158260 [info ] [MainThread]: 
[0m02:51:06.161259 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m02:51:06.161259 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m02:51:06.162260 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m02:51:06.162260 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m02:51:06.163259 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m02:51:06.165261 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m02:51:06.166259 [debug] [Thread-1  ]: finished collecting timing info
[0m02:51:06.166259 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m02:51:06.178260 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:51:06.673167 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m02:51:06.673167 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        url,
        'Guess' as brand,
        size,
        color,
        ifnull(REPLACE(old_price,'CAD',''),'0') as old_price,
        ifnull(REPLACE(new_price,'CAD',''),'0') as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),

final as (
    select 
        id,
        url,
        brand,
        size,
        color,
        ROUND(safe_cast(old_price as FLOAT64) * rates.rate,1) as old_price_jpy,
        ROUND(safe_cast(new_price as FLOAT64) * rates.rate,1) as new_price_jpy,
        name,
        description,
        image_str,
        SPLIT(image_str,'|')[OFFSET(1)] AS Thumbnail, --the first image
        current_timestamp as dbt_updated_at

    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data_transform.echange_rate_id

) 

select * from final
    );
  
[0m02:51:07.501893 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Array index 1 is out of bounds (overflow)')
[0m02:51:10.013573 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:us-central1:a0e54659-9802-4f6d-958e-3383f4e4bb27&page=queryresults
[0m02:51:10.014487 [debug] [Thread-1  ]: finished collecting timing info
[0m02:51:10.015492 [debug] [Thread-1  ]: Database Error in model guess_data_clean (models\views\guess_data_clean.sql)
  Array index 1 is out of bounds (overflow)
  compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m02:51:10.015492 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6494eebc-493f-4163-a1ad-c7505e1a6048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE5770DF0>]}
[0m02:51:10.015492 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model buyma_ruoyu.guess_data_clean ............. [[31mERROR[0m in 3.85s]
[0m02:51:10.016493 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m02:51:10.017493 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:51:10.017493 [info ] [MainThread]: 
[0m02:51:10.018494 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m02:51:10.018494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:51:10.019494 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m02:51:10.019494 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m02:51:10.019494 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m02:51:10.024493 [info ] [MainThread]: 
[0m02:51:10.025493 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:51:10.025493 [info ] [MainThread]: 
[0m02:51:10.025493 [error] [MainThread]: [33mDatabase Error in model guess_data_clean (models\views\guess_data_clean.sql)[0m
[0m02:51:10.026494 [error] [MainThread]:   Array index 1 is out of bounds (overflow)
[0m02:51:10.026494 [error] [MainThread]:   compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m02:51:10.027492 [info ] [MainThread]: 
[0m02:51:10.027492 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:51:10.028494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE572E2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE55709D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE57BE6A0>]}
[0m02:51:10.028494 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 02:51:30.532634 | df8bac28-4e37-414f-a518-6562202808be ==============================
[0m02:51:30.532634 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:51:30.533634 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:51:30.533634 [debug] [MainThread]: Tracking: tracking
[0m02:51:30.533634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3BB381B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3BB381C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3BB381C10>]}
[0m02:51:30.594634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:51:30.594634 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:51:30.594634 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m02:51:30.600634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df8bac28-4e37-414f-a518-6562202808be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3BB50E940>]}
[0m02:51:30.606635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df8bac28-4e37-414f-a518-6562202808be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3BB43E040>]}
[0m02:51:30.606635 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m02:51:30.607634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df8bac28-4e37-414f-a518-6562202808be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3BB4E0DF0>]}
[0m02:51:30.608636 [info ] [MainThread]: 
[0m02:51:30.608636 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:51:30.609635 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m02:51:30.609635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:51:31.365186 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m02:51:31.365186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:51:31.827062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df8bac28-4e37-414f-a518-6562202808be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3BB3994F0>]}
[0m02:51:31.828061 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:51:31.828061 [info ] [MainThread]: 
[0m02:51:31.832062 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m02:51:31.832062 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m02:51:31.833063 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m02:51:31.833063 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m02:51:31.833063 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m02:51:31.836061 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m02:51:31.837062 [debug] [Thread-1  ]: finished collecting timing info
[0m02:51:31.837062 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m02:51:31.849084 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:51:32.382812 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m02:51:32.383813 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        url,
        'Guess' as brand,
        size,
        color,
        ifnull(REPLACE(old_price,'CAD',''),'0') as old_price,
        ifnull(REPLACE(new_price,'CAD',''),'0') as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),

final as (
    select 
        id,
        url,
        brand,
        size,
        color,
        ROUND(safe_cast(old_price as FLOAT64) * rates.rate,1) as old_price_jpy,
        ROUND(safe_cast(new_price as FLOAT64) * rates.rate,1) as new_price_jpy,
        name,
        description,
        image_str,
        SPLIT(image_str,'|')[OFFSET(1)] AS Thumbnail, --the first image
        current_timestamp as dbt_updated_at

    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data_transform.echange_rate_id

) 

select * from final
    );
  
[0m02:51:33.247376 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Array index 1 is out of bounds (overflow)')
[0m02:51:35.694987 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:us-central1:cc3ff05d-919b-49af-98d0-326c1b7e8370&page=queryresults
[0m02:51:35.695985 [debug] [Thread-1  ]: finished collecting timing info
[0m02:51:35.695985 [debug] [Thread-1  ]: Database Error in model guess_data_clean (models\views\guess_data_clean.sql)
  Array index 1 is out of bounds (overflow)
  compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m02:51:35.696985 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df8bac28-4e37-414f-a518-6562202808be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3BB5A0610>]}
[0m02:51:35.696985 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model buyma_ruoyu.guess_data_clean ............. [[31mERROR[0m in 3.86s]
[0m02:51:35.697975 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m02:51:35.698975 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:51:35.698975 [info ] [MainThread]: 
[0m02:51:35.699976 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.09 seconds (5.09s).
[0m02:51:35.699976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:51:35.699976 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m02:51:35.699976 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m02:51:35.700985 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m02:51:35.705976 [info ] [MainThread]: 
[0m02:51:35.706975 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:51:35.706975 [info ] [MainThread]: 
[0m02:51:35.707975 [error] [MainThread]: [33mDatabase Error in model guess_data_clean (models\views\guess_data_clean.sql)[0m
[0m02:51:35.707975 [error] [MainThread]:   Array index 1 is out of bounds (overflow)
[0m02:51:35.708976 [error] [MainThread]:   compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m02:51:35.708976 [info ] [MainThread]: 
[0m02:51:35.708976 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:51:35.709975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3BB5A0FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3BB4E09A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3BB5B43D0>]}
[0m02:51:35.709975 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 02:51:43.414096 | b095f9b8-ebc4-4e0a-8948-3c015b6fda51 ==============================
[0m02:51:43.414096 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:51:43.415096 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:51:43.415096 [debug] [MainThread]: Tracking: tracking
[0m02:51:43.415096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FED4D1AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FED4D1BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FED4D1B80>]}
[0m02:51:43.473096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:51:43.473096 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m02:51:43.484098 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m02:51:43.502098 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m02:51:43.507098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b095f9b8-ebc4-4e0a-8948-3c015b6fda51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FED656E80>]}
[0m02:51:43.512097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b095f9b8-ebc4-4e0a-8948-3c015b6fda51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FED631D00>]}
[0m02:51:43.512097 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m02:51:43.513097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b095f9b8-ebc4-4e0a-8948-3c015b6fda51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FED631CA0>]}
[0m02:51:43.514098 [info ] [MainThread]: 
[0m02:51:43.514098 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:51:43.515098 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m02:51:43.515098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:51:43.981011 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m02:51:43.982014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:51:44.395058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b095f9b8-ebc4-4e0a-8948-3c015b6fda51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FED4E9AF0>]}
[0m02:51:44.395058 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:51:44.396059 [info ] [MainThread]: 
[0m02:51:44.400058 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m02:51:44.400058 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m02:51:44.401059 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m02:51:44.401059 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m02:51:44.401059 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m02:51:44.404060 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m02:51:44.405060 [debug] [Thread-1  ]: finished collecting timing info
[0m02:51:44.405060 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m02:51:44.417059 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:51:44.953549 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m02:51:44.954548 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        url,
        'Guess' as brand,
        size,
        color,
        ifnull(REPLACE(old_price,'CAD',''),'0') as old_price,
        ifnull(REPLACE(new_price,'CAD',''),'0') as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),

final as (
    select 
        id,
        url,
        brand,
        size,
        color,
        ROUND(safe_cast(old_price as FLOAT64) * rates.rate,1) as old_price_jpy,
        ROUND(safe_cast(new_price as FLOAT64) * rates.rate,1) as new_price_jpy,
        name,
        description,
        image_str,
        SPLIT(image_str,'|')[OFFSET(0)] AS Thumbnail, --the first image
        current_timestamp as dbt_updated_at

    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data_transform.echange_rate_id

) 

select * from final
    );
  
[0m02:51:46.984422 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:32062bfe-fbc7-4403-ad40-c8d86673b47c:us-central1&page=queryresults
[0m02:51:46.998424 [debug] [Thread-1  ]: finished collecting timing info
[0m02:51:46.999422 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b095f9b8-ebc4-4e0a-8948-3c015b6fda51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FED88EA30>]}
[0m02:51:46.999422 [info ] [Thread-1  ]: 1 of 1 OK created sql table model buyma_ruoyu.guess_data_clean ................. [[32mCREATE TABLE (430.0 rows, 426.7 KB processed)[0m in 2.60s]
[0m02:51:47.000171 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m02:51:47.001184 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:51:47.002183 [info ] [MainThread]: 
[0m02:51:47.002183 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m02:51:47.002183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:51:47.003186 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m02:51:47.003186 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m02:51:47.003186 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m02:51:47.008184 [info ] [MainThread]: 
[0m02:51:47.008184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:51:47.009183 [info ] [MainThread]: 
[0m02:51:47.009183 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:51:47.010183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FED7F9DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FED631A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FED828CA0>]}
[0m02:51:47.010183 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 03:12:28.463444 | cbec4977-2d38-4df1-86c6-4174aaf98e26 ==============================
[0m03:12:28.463444 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:12:28.464446 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:12:28.464446 [debug] [MainThread]: Tracking: tracking
[0m03:12:28.464446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABA0E3D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABA0E3D610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABA0E3D5E0>]}
[0m03:12:28.522444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:12:28.523446 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m03:12:28.533445 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m03:12:28.552445 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m03:12:28.557445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbec4977-2d38-4df1-86c6-4174aaf98e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABA0FAC760>]}
[0m03:12:28.563445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbec4977-2d38-4df1-86c6-4174aaf98e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABA0E52DC0>]}
[0m03:12:28.563445 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m03:12:28.564445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbec4977-2d38-4df1-86c6-4174aaf98e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABA0E52940>]}
[0m03:12:28.565445 [info ] [MainThread]: 
[0m03:12:28.565445 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:12:28.566445 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m03:12:28.566445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:29.053603 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m03:12:29.053603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:29.494580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:29.494580 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m03:12:29.494580 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m03:12:29.494580 [debug] [MainThread]: Flushing usage events
[0m03:12:29.656796 [info ] [MainThread]: ctrl-c


============================== 2022-12-05 03:12:34.658047 | 3cb93424-054b-4fbe-a225-d8f892b424a8 ==============================
[0m03:12:34.658047 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:12:34.659047 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:12:34.659047 [debug] [MainThread]: Tracking: tracking
[0m03:12:34.659047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245B347C760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245B347C820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245B347C7F0>]}
[0m03:12:34.719048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:12:34.719048 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m03:12:34.730049 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m03:12:34.751047 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m03:12:34.757051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cb93424-054b-4fbe-a225-d8f892b424a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245B35F5040>]}
[0m03:12:34.763047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cb93424-054b-4fbe-a225-d8f892b424a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245B3492940>]}
[0m03:12:34.763047 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m03:12:34.764048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cb93424-054b-4fbe-a225-d8f892b424a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245B3492A30>]}
[0m03:12:34.765047 [info ] [MainThread]: 
[0m03:12:34.766046 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:12:34.767049 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m03:12:34.767049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:35.201040 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m03:12:35.201040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:35.657577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cb93424-054b-4fbe-a225-d8f892b424a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245B34F4A00>]}
[0m03:12:35.658576 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:12:35.658576 [info ] [MainThread]: 
[0m03:12:35.661576 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m03:12:35.662575 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m03:12:35.662575 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m03:12:35.662575 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m03:12:35.662575 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m03:12:35.665577 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m03:12:35.666575 [debug] [Thread-1  ]: finished collecting timing info
[0m03:12:35.666575 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m03:12:35.678575 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:12:36.245572 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m03:12:36.246572 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        url,
        'Guess' as brand,
        size,
        color,
        ifnull(REPLACE(old_price,'CAD',''),'0') as old_price,
        ifnull(REPLACE(new_price,'CAD',''),'0') as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),


 --https://www.guess.com/ca/en/men/apparel/jeans-and-denim/tapered/eco-distressed-tapered-jeans-blue/M2YAS2D4K32-FRMN.html
-- https://www.guess.com/ca/en/men/apparel/jackets-and-coats/puffer-coats/arctic-patch-metallic-puffer-jacket-silver/M3RL50RCXP0-G9F9.html

final as (
    select 
        id,
        url,
        brand,
        CASE 
            when SPLIT(url,'/')[OFFSET(6)] = 'features' then SPLIT(url,'/')[OFFSET(8)] 
            when SPLIT(url,'/')[OFFSET(6)] = 'apparel' then SPLIT(url,'/')[OFFSET(7)] 
        end as category
        size,
        color,
        ROUND(safe_cast(old_price as FLOAT64) * rates.rate,1) as old_price_jpy,
        ROUND(safe_cast(new_price as FLOAT64) * rates.rate,1) as new_price_jpy,
        name,
        description,
        image_str,
        SPLIT(image_str,'|')[OFFSET(0)] AS Thumbnail, --the first image
        current_timestamp as dbt_updated_at

    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data_transform.echange_rate_id
    where id <> 'GMDOLO-MBRLL'
) 

select * from final
    );
  
[0m03:12:36.460723 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "size" at [51:9]')
[0m03:12:37.216530 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:us-central1:d6cb9c1a-a49d-44ca-a1df-5c2441a3bcdc&page=queryresults
[0m03:12:37.216530 [debug] [Thread-1  ]: finished collecting timing info
[0m03:12:37.217531 [debug] [Thread-1  ]: Database Error in model guess_data_clean (models\views\guess_data_clean.sql)
  Syntax error: Expected ")" but got identifier "size" at [51:9]
  compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m03:12:37.217531 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cb93424-054b-4fbe-a225-d8f892b424a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245B37AC8E0>]}
[0m03:12:37.217531 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model buyma_ruoyu.guess_data_clean ............. [[31mERROR[0m in 1.55s]
[0m03:12:37.218529 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m03:12:37.218529 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:12:37.219530 [info ] [MainThread]: 
[0m03:12:37.219530 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m03:12:37.219530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:37.219530 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m03:12:37.220529 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m03:12:37.220529 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m03:12:37.225529 [info ] [MainThread]: 
[0m03:12:37.225529 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:12:37.226529 [info ] [MainThread]: 
[0m03:12:37.226529 [error] [MainThread]: [33mDatabase Error in model guess_data_clean (models\views\guess_data_clean.sql)[0m
[0m03:12:37.226529 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "size" at [51:9]
[0m03:12:37.227529 [error] [MainThread]:   compiled Code at target\run\buyma\models\views\guess_data_clean.sql
[0m03:12:37.227529 [info ] [MainThread]: 
[0m03:12:37.228529 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:12:37.228529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245B3620AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245B380B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245B382BD00>]}
[0m03:12:37.228529 [debug] [MainThread]: Flushing usage events


============================== 2022-12-05 03:12:50.118527 | cba44b6f-afe6-4943-87e3-c16a11560ee2 ==============================
[0m03:12:50.118527 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:12:50.118527 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Ruoyu\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['guess_data_clean'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:12:50.118527 [debug] [MainThread]: Tracking: tracking
[0m03:12:50.119529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B8162C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B8162D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B8162D00>]}
[0m03:12:50.177528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:12:50.177528 [debug] [MainThread]: Partial parsing: updated file: buyma://models\views\guess_data_clean.sql
[0m03:12:50.187527 [debug] [MainThread]: 1699: static parser successfully parsed views\guess_data_clean.sql
[0m03:12:50.205528 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buyma.example

[0m03:12:50.211529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cba44b6f-afe6-4943-87e3-c16a11560ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B82E4EE0>]}
[0m03:12:50.217527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cba44b6f-afe6-4943-87e3-c16a11560ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B82C0E80>]}
[0m03:12:50.217527 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m03:12:50.218528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cba44b6f-afe6-4943-87e3-c16a11560ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B82C0E20>]}
[0m03:12:50.218528 [info ] [MainThread]: 
[0m03:12:50.219529 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:12:50.220528 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement"
[0m03:12:50.220528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:50.732525 [debug] [ThreadPool]: Acquiring new bigquery connection "list_buymamanagement_buyma_ruoyu"
[0m03:12:50.732525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:51.453522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cba44b6f-afe6-4943-87e3-c16a11560ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B8179670>]}
[0m03:12:51.453522 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:12:51.454522 [info ] [MainThread]: 
[0m03:12:51.457522 [debug] [Thread-1  ]: Began running node model.buyma.guess_data_clean
[0m03:12:51.457522 [info ] [Thread-1  ]: 1 of 1 START sql table model buyma_ruoyu.guess_data_clean ...................... [RUN]
[0m03:12:51.458522 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.buyma.guess_data_clean"
[0m03:12:51.458522 [debug] [Thread-1  ]: Began compiling node model.buyma.guess_data_clean
[0m03:12:51.458522 [debug] [Thread-1  ]: Compiling model.buyma.guess_data_clean
[0m03:12:51.461521 [debug] [Thread-1  ]: Writing injected SQL for node "model.buyma.guess_data_clean"
[0m03:12:51.462521 [debug] [Thread-1  ]: finished collecting timing info
[0m03:12:51.462521 [debug] [Thread-1  ]: Began executing node model.buyma.guess_data_clean
[0m03:12:51.474524 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:12:52.007866 [debug] [Thread-1  ]: Writing runtime sql for node "model.buyma.guess_data_clean"
[0m03:12:52.007866 [debug] [Thread-1  ]: On model.buyma.guess_data_clean: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "buyma", "target_name": "dev", "node_id": "model.buyma.guess_data_clean"} */

  
    

    create or replace table `buymamanagement`.`buyma_ruoyu`.`guess_data_clean`
    
    
    OPTIONS()
    as (
      

with guess_data as (
    select * from `buymamanagement`.`buyma_ruoyu`.`guess_data`
),

rates as (
    select * from `buymamanagement`.`buyma_ruoyu`.`exchange_rates`
),

guess_data_transform as (
    select
        id,
        url,
        'Guess' as brand,
        size,
        color,
        ifnull(REPLACE(old_price,'CAD',''),'0') as old_price,
        ifnull(REPLACE(new_price,'CAD',''),'0') as new_price,
        name,
        description,
        image_str,
        '1' AS echange_rate_id, 

    from guess_data
),


 --https://www.guess.com/ca/en/men/apparel/jeans-and-denim/tapered/eco-distressed-tapered-jeans-blue/M2YAS2D4K32-FRMN.html
-- https://www.guess.com/ca/en/men/apparel/jackets-and-coats/puffer-coats/arctic-patch-metallic-puffer-jacket-silver/M3RL50RCXP0-G9F9.html

final as (
    select 
        id,
        url,
        brand,
        CASE 
            when SPLIT(url,'/')[OFFSET(6)] = 'features' then SPLIT(url,'/')[OFFSET(8)] 
            when SPLIT(url,'/')[OFFSET(6)] = 'apparel' then SPLIT(url,'/')[OFFSET(7)] 
        end as category,
        size,
        color,
        ROUND(safe_cast(old_price as FLOAT64) * rates.rate,1) as old_price_jpy,
        ROUND(safe_cast(new_price as FLOAT64) * rates.rate,1) as new_price_jpy,
        name,
        description,
        image_str,
        SPLIT(image_str,'|')[OFFSET(0)] AS Thumbnail, --the first image
        current_timestamp as dbt_updated_at

    from guess_data_transform
    left join rates
    on rates.rate_id = guess_data_transform.echange_rate_id
    where id <> 'GMDOLO-MBRLL'
) 

select * from final
    );
  
[0m03:12:54.489092 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=buymamanagement&j=bq:07bb419c-c3ca-4275-b5c2-a4715ccd3fe2:us-central1&page=queryresults
[0m03:12:54.502090 [debug] [Thread-1  ]: finished collecting timing info
[0m03:12:54.503090 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba44b6f-afe6-4943-87e3-c16a11560ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B84BAAC0>]}
[0m03:12:54.503090 [info ] [Thread-1  ]: 1 of 1 OK created sql table model buyma_ruoyu.guess_data_clean ................. [[32mCREATE TABLE (429.0 rows, 426.7 KB processed)[0m in 3.04s]
[0m03:12:54.504080 [debug] [Thread-1  ]: Finished running node model.buyma.guess_data_clean
[0m03:12:54.505081 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:12:54.505081 [info ] [MainThread]: 
[0m03:12:54.506090 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.29 seconds (4.29s).
[0m03:12:54.506090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:54.506090 [debug] [MainThread]: Connection 'list_buymamanagement' was properly closed.
[0m03:12:54.506090 [debug] [MainThread]: Connection 'list_buymamanagement_buyma_ruoyu' was properly closed.
[0m03:12:54.506090 [debug] [MainThread]: Connection 'model.buyma.guess_data_clean' was properly closed.
[0m03:12:54.512080 [info ] [MainThread]: 
[0m03:12:54.512080 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:54.513080 [info ] [MainThread]: 
[0m03:12:54.513080 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:12:54.513080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B84FBCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B82C09D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B84B1CA0>]}
[0m03:12:54.514080 [debug] [MainThread]: Flushing usage events
